{"version":3,"file":"sound.js","sourceRoot":"","sources":["../../../../dev/core/src/Audio/sound.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IStaticSoundOptions, IStaticSoundPlayOptions, IStaticSoundStopOptions } from \"../AudioV2/abstractAudio/staticSound\";\r\nimport type { IStreamingSoundOptions } from \"../AudioV2/abstractAudio/streamingSound\";\r\nimport { _HasSpatialAudioOptions, _SpatialAudioDefaults } from \"../AudioV2/abstractAudio/subProperties/abstractSpatialAudio\";\r\nimport type { IAudioParameterRampOptions } from \"../AudioV2/audioParameter\";\r\nimport { AudioParameterRampShape } from \"../AudioV2/audioParameter\";\r\nimport { SoundState } from \"../AudioV2/soundState\";\r\nimport { _WebAudioSoundSource } from \"../AudioV2/webAudio/webAudioSoundSource\";\r\nimport { _WebAudioStaticSound } from \"../AudioV2/webAudio/webAudioStaticSound\";\r\nimport { _WebAudioStreamingSound } from \"../AudioV2/webAudio/webAudioStreamingSound\";\r\nimport { AbstractEngine } from \"../Engines/abstractEngine\";\r\nimport { EngineStore } from \"../Engines/engineStore\";\r\nimport { Vector3 } from \"../Maths/math.vector\";\r\nimport type { AbstractMesh } from \"../Meshes/abstractMesh\";\r\nimport type { TransformNode } from \"../Meshes/transformNode\";\r\nimport { _WarnImport } from \"../Misc/devTools\";\r\nimport { Logger } from \"../Misc/logger\";\r\nimport { Observable } from \"../Misc/observable\";\r\nimport { _RetryWithInterval } from \"../Misc/timingTools\";\r\nimport { RegisterClass } from \"../Misc/typeStore\";\r\nimport type { Scene } from \"../scene\";\r\nimport type { Nullable } from \"../types\";\r\nimport type { AudioEngine } from \"./audioEngine\";\r\nimport type { ISoundOptions } from \"./Interfaces/ISoundOptions\";\r\n\r\nconst TmpRampOptions: IAudioParameterRampOptions = {\r\n    duration: 0,\r\n    shape: AudioParameterRampShape.Linear,\r\n};\r\n\r\nconst TmpPlayOptions: Partial<IStaticSoundPlayOptions> = {\r\n    duration: 0,\r\n    startOffset: 0,\r\n    waitTime: 0,\r\n};\r\n\r\nconst TmpStopOptions: IStaticSoundStopOptions = {\r\n    waitTime: 0,\r\n};\r\n\r\nfunction D2r(degrees: number): number {\r\n    return (degrees * Math.PI) / 180;\r\n}\r\n\r\nfunction R2d(radians: number): number {\r\n    return (radians * 180) / Math.PI;\r\n}\r\n\r\n/**\r\n * Defines a sound that can be played in the application.\r\n * The sound can either be an ambient track or a simple sound played in reaction to a user action.\r\n * @see https://doc.babylonjs.com/legacy/audio\r\n */\r\nexport class Sound {\r\n    /**\r\n     * The name of the sound in the scene.\r\n     */\r\n    public get name(): string {\r\n        return this._soundV2.name;\r\n    }\r\n\r\n    public set name(value: string) {\r\n        this._soundV2.name = value;\r\n    }\r\n\r\n    /**\r\n     * Does the sound autoplay once loaded.\r\n     */\r\n    public get autoplay(): boolean {\r\n        return this._soundV2 instanceof _WebAudioSoundSource ? true : this._optionsV2.autoplay!;\r\n    }\r\n\r\n    public set autoplay(value: boolean) {\r\n        this._optionsV2.autoplay = value;\r\n    }\r\n\r\n    /**\r\n     * Does the sound loop after it finishes playing once.\r\n     */\r\n    public get loop(): boolean {\r\n        return this._soundV2 instanceof _WebAudioSoundSource ? true : this._soundV2.loop;\r\n    }\r\n\r\n    public set loop(value: boolean) {\r\n        if (this._soundV2 instanceof _WebAudioSoundSource) {\r\n            return;\r\n        }\r\n\r\n        if (this._soundV2) {\r\n            this._soundV2.loop = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Does the sound use a custom attenuation curve to simulate the falloff\r\n     * happening when the source gets further away from the camera.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-your-own-custom-attenuation-function\r\n     */\r\n    public useCustomAttenuation: boolean = false;\r\n    /**\r\n     * The sound track id this sound belongs to.\r\n     */\r\n    public soundTrackId: number = -1;\r\n    /**\r\n     * Is this sound currently played.\r\n     */\r\n    public get isPlaying(): boolean {\r\n        return this._soundV2 instanceof _WebAudioSoundSource ? true : this._soundV2?.state === SoundState.Started || (!this.isReady() && this._optionsV2.autoplay!);\r\n    }\r\n\r\n    /**\r\n     * Is this sound currently paused.\r\n     */\r\n    public get isPaused(): boolean {\r\n        return this._soundV2 instanceof _WebAudioSoundSource ? false : this._soundV2.state === SoundState.Paused;\r\n    }\r\n\r\n    /**\r\n     * Define the reference distance the sound should be heard perfectly.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public refDistance: number = 1;\r\n    /**\r\n     * Define the roll off factor of spatial sounds.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public rolloffFactor: number = 1;\r\n    /**\r\n     * Define the max distance the sound should be heard (intensity just became 0 at this point).\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public get maxDistance(): number {\r\n        return this._optionsV2.spatialMaxDistance || 100;\r\n    }\r\n    public set maxDistance(value: number) {\r\n        this._optionsV2.spatialMaxDistance = value;\r\n\r\n        if (this.useCustomAttenuation) {\r\n            return;\r\n        }\r\n\r\n        if (this._soundV2) {\r\n            this._initSpatial();\r\n            this._soundV2.spatial.maxDistance = value;\r\n        }\r\n    }\r\n    /**\r\n     * Define the distance attenuation model the sound will follow.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public get distanceModel(): \"linear\" | \"inverse\" | \"exponential\" {\r\n        return this._optionsV2.spatialDistanceModel || \"linear\";\r\n    }\r\n    public set distanceModel(value: \"linear\" | \"inverse\" | \"exponential\") {\r\n        this._optionsV2.spatialDistanceModel = value;\r\n\r\n        if (this._soundV2) {\r\n            this._initSpatial();\r\n            this._soundV2.spatial.distanceModel = value;\r\n        }\r\n    }\r\n    /**\r\n     * @internal\r\n     * Back Compat\r\n     **/\r\n    public onended: () => any;\r\n    /**\r\n     * Gets or sets an object used to store user defined information for the sound.\r\n     */\r\n    public metadata: any = null;\r\n\r\n    /**\r\n     * Observable event when the current playing sound finishes.\r\n     */\r\n    public onEndedObservable = new Observable<Sound>();\r\n\r\n    /**\r\n     * Gets the current time for the sound.\r\n     */\r\n    public get currentTime(): number {\r\n        return this._soundV2 instanceof _WebAudioSoundSource ? this._soundV2.engine.currentTime : this._soundV2.currentTime;\r\n    }\r\n\r\n    /**\r\n     * Does this sound enables spatial sound.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public get spatialSound(): boolean {\r\n        return this._soundV2?._isSpatial ?? false;\r\n    }\r\n\r\n    /**\r\n     * Does this sound enables spatial sound.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public set spatialSound(newValue: boolean) {\r\n        if (this._soundV2) {\r\n            if (newValue) {\r\n                this._initSpatial();\r\n            } else {\r\n                this._soundV2._isSpatial = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _localDirection: Vector3 = new Vector3(1, 0, 0);\r\n    private _volume: number = 1;\r\n    private _isReadyToPlay: boolean = false;\r\n    private _isDirectional: boolean = false;\r\n    private _readyToPlayCallback: () => any;\r\n    private _scene: Scene;\r\n    private _connectedTransformNode: Nullable<TransformNode>;\r\n    private _customAttenuationFunction: (currentVolume: number, currentDistance: number, maxDistance: number, refDistance: number, rolloffFactor: number) => number;\r\n    private _registerFunc: Nullable<(connectedMesh: TransformNode) => void>;\r\n    private _isOutputConnected = false;\r\n    private _url: Nullable<string> = null;\r\n\r\n    private readonly _optionsV2: Partial<IStaticSoundOptions>;\r\n    private readonly _soundV2: _WebAudioSoundSource | _WebAudioStaticSound | _WebAudioStreamingSound;\r\n    private _onReadyObservable: Nullable<Observable<void>> = null;\r\n\r\n    private get _onReady(): Observable<void> {\r\n        if (!this._onReadyObservable) {\r\n            this._onReadyObservable = new Observable<void>();\r\n        }\r\n        return this._onReadyObservable;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public static _SceneComponentInitialization: (scene: Scene) => void = (_) => {\r\n        throw _WarnImport(\"AudioSceneComponent\");\r\n    };\r\n\r\n    /**\r\n     * Create a sound and attach it to a scene\r\n     * @param name Name of your sound\r\n     * @param urlOrArrayBuffer Url to the sound to load async or ArrayBuffer, it also works with MediaStreams and AudioBuffers\r\n     * @param scene defines the scene the sound belongs to\r\n     * @param readyToPlayCallback Provide a callback function if you'd like to load your code once the sound is ready to be played\r\n     * @param options Objects to provide with the current available options: autoplay, loop, volume, spatialSound, maxDistance, rolloffFactor, refDistance, distanceModel, panningModel, streaming\r\n     */\r\n    constructor(name: string, urlOrArrayBuffer: any, scene?: Nullable<Scene>, readyToPlayCallback: Nullable<() => void> = null, options?: ISoundOptions) {\r\n        scene = scene || EngineStore.LastCreatedScene;\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        this._scene = scene;\r\n        Sound._SceneComponentInitialization(scene);\r\n        this._readyToPlayCallback = readyToPlayCallback || (() => {});\r\n\r\n        // Default custom attenuation function is a linear attenuation\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        this._customAttenuationFunction = (currentVolume: number, currentDistance: number, maxDistance: number, refDistance: number, rolloffFactor: number) => {\r\n            if (currentDistance < maxDistance) {\r\n                return currentVolume * (1 - currentDistance / maxDistance);\r\n            } else {\r\n                return 0;\r\n            }\r\n        };\r\n\r\n        options = options || {};\r\n\r\n        const optionsV2: Partial<IStaticSoundOptions> = {\r\n            analyzerEnabled: false,\r\n            autoplay: false, // `false` for now, but will be set to given option later\r\n            duration: options.length || 0,\r\n            loop: options.loop || false,\r\n            loopEnd: 0,\r\n            loopStart: 0,\r\n            outBus: null,\r\n            outBusAutoDefault: false,\r\n            playbackRate: options.playbackRate || 1,\r\n            pitch: 0,\r\n            skipCodecCheck: options.skipCodecCheck || false,\r\n            spatialDistanceModel: options.distanceModel,\r\n            spatialEnabled: options.spatialSound,\r\n            spatialMaxDistance: options.maxDistance,\r\n            spatialMinDistance: options.refDistance,\r\n            spatialRolloffFactor: options.rolloffFactor,\r\n            stereoEnabled: false,\r\n            startOffset: options.offset || 0,\r\n            volume: options.volume ?? 1,\r\n        };\r\n        this._volume = options.volume ?? 1;\r\n\r\n        if (_HasSpatialAudioOptions(optionsV2)) {\r\n            optionsV2.spatialAutoUpdate = false;\r\n            optionsV2.spatialConeInnerAngle = _SpatialAudioDefaults.coneInnerAngle;\r\n            optionsV2.spatialConeOuterAngle = _SpatialAudioDefaults.coneOuterAngle;\r\n            optionsV2.spatialConeOuterVolume = _SpatialAudioDefaults.coneOuterVolume;\r\n            optionsV2.spatialMinUpdateTime = 0;\r\n            optionsV2.spatialOrientation = _SpatialAudioDefaults.orientation.clone();\r\n            optionsV2.spatialPanningModel = (this._scene.headphone ? \"HRTF\" : \"equalpower\") as \"equalpower\" | \"HRTF\";\r\n            optionsV2.spatialPosition = _SpatialAudioDefaults.position.clone();\r\n            optionsV2.spatialRotation = _SpatialAudioDefaults.rotation.clone();\r\n            optionsV2.spatialRotationQuaternion = _SpatialAudioDefaults.rotationQuaternion.clone();\r\n\r\n            if (optionsV2.spatialMaxDistance === undefined) {\r\n                optionsV2.spatialMaxDistance = 100;\r\n            }\r\n        }\r\n\r\n        this._optionsV2 = { ...optionsV2 };\r\n        this._optionsV2.autoplay = options.autoplay || false;\r\n\r\n        this.useCustomAttenuation = options.useCustomAttenuation ?? false;\r\n        if (this.useCustomAttenuation) {\r\n            optionsV2.spatialMaxDistance = Number.MAX_VALUE;\r\n            optionsV2.volume = 0;\r\n        }\r\n\r\n        let streaming = options?.streaming || false;\r\n\r\n        const audioEngine = AbstractEngine.audioEngine;\r\n        if (!audioEngine) {\r\n            return;\r\n        }\r\n\r\n        const audioEngineV2 = (AbstractEngine.audioEngine as AudioEngine)._v2;\r\n\r\n        const createSoundV2 = () => {\r\n            if (streaming) {\r\n                const streamingOptionsV2: Partial<IStreamingSoundOptions> = {\r\n                    preloadCount: 0,\r\n                    ...optionsV2,\r\n                };\r\n\r\n                const sound = new _WebAudioStreamingSound(name, audioEngineV2, streamingOptionsV2);\r\n\r\n                // eslint-disable-next-line github/no-then\r\n                void sound._initAsync(urlOrArrayBuffer, optionsV2).then(() => {\r\n                    // eslint-disable-next-line github/no-then\r\n                    void sound.preloadInstancesAsync(1).then(this._onReadyToPlay);\r\n                });\r\n\r\n                return sound;\r\n            } else {\r\n                const sound = new _WebAudioStaticSound(name, audioEngineV2, optionsV2);\r\n\r\n                // eslint-disable-next-line github/no-then\r\n                void sound._initAsync(urlOrArrayBuffer, optionsV2).then(this._onReadyToPlay);\r\n\r\n                return sound;\r\n            }\r\n        };\r\n\r\n        // If no parameter is passed then the setAudioBuffer should be called to prepare the sound.\r\n        if (!urlOrArrayBuffer) {\r\n            // Create the sound but don't call _initAsync on it, yet. Call it later when `setAudioBuffer` is called.\r\n            this._soundV2 = new _WebAudioStaticSound(name, audioEngineV2, optionsV2);\r\n        } else if (typeof urlOrArrayBuffer === \"string\") {\r\n            this._url = urlOrArrayBuffer;\r\n            this._soundV2 = createSoundV2();\r\n        } else if (urlOrArrayBuffer instanceof ArrayBuffer) {\r\n            streaming = false;\r\n            this._soundV2 = createSoundV2();\r\n        } else if (urlOrArrayBuffer instanceof HTMLMediaElement) {\r\n            streaming = true;\r\n            this._soundV2 = createSoundV2();\r\n        } else if (urlOrArrayBuffer instanceof MediaStream) {\r\n            const node = new MediaStreamAudioSourceNode(audioEngineV2._audioContext, { mediaStream: urlOrArrayBuffer });\r\n            this._soundV2 = new _WebAudioSoundSource(name, node, audioEngineV2, optionsV2);\r\n            // eslint-disable-next-line github/no-then\r\n            void this._soundV2._initAsync(optionsV2).then(this._onReadyToPlay);\r\n        } else if (urlOrArrayBuffer instanceof AudioBuffer) {\r\n            streaming = false;\r\n            this._soundV2 = createSoundV2();\r\n        } else if (Array.isArray(urlOrArrayBuffer)) {\r\n            this._soundV2 = createSoundV2();\r\n        }\r\n\r\n        if (!this._soundV2) {\r\n            Logger.Error(\"Parameter must be a URL to the sound, an Array of URLs (.mp3 & .ogg) or an ArrayBuffer of the sound.\");\r\n            return;\r\n        }\r\n\r\n        if (!(this._soundV2 instanceof _WebAudioSoundSource)) {\r\n            this._soundV2.onEndedObservable.add(this._onended);\r\n        }\r\n    }\r\n\r\n    private _onReadyToPlay = () => {\r\n        this._scene.mainSoundTrack.addSound(this);\r\n        this._isReadyToPlay = true;\r\n        this._readyToPlayCallback();\r\n\r\n        if (this._onReadyObservable) {\r\n            this._onReadyObservable.notifyObservers();\r\n        }\r\n\r\n        if (this._optionsV2.autoplay) {\r\n            this.play();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Release the sound and its associated resources\r\n     */\r\n    public dispose() {\r\n        if (this.isPlaying) {\r\n            this.stop();\r\n        }\r\n        this._isReadyToPlay = false;\r\n        if (this.soundTrackId === -1) {\r\n            this._scene.mainSoundTrack.removeSound(this);\r\n        } else if (this._scene.soundTracks) {\r\n            this._scene.soundTracks[this.soundTrackId].removeSound(this);\r\n        }\r\n\r\n        if (this._connectedTransformNode && this._registerFunc) {\r\n            this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc);\r\n            this._connectedTransformNode = null;\r\n        }\r\n\r\n        this._soundV2.dispose();\r\n    }\r\n\r\n    /**\r\n     * Gets if the sounds is ready to be played or not.\r\n     * @returns true if ready, otherwise false\r\n     */\r\n    public isReady(): boolean {\r\n        return this._isReadyToPlay;\r\n    }\r\n\r\n    /**\r\n     * Get the current class name.\r\n     * @returns current class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"Sound\";\r\n    }\r\n\r\n    /**\r\n     * Sets the data of the sound from an audiobuffer\r\n     * @param audioBuffer The audioBuffer containing the data\r\n     */\r\n    public setAudioBuffer(audioBuffer: AudioBuffer): void {\r\n        if (this._isReadyToPlay) {\r\n            return;\r\n        }\r\n\r\n        if (this._soundV2 instanceof _WebAudioStaticSound) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises, github/no-then\r\n            this._soundV2._initAsync(audioBuffer, this._optionsV2).then(this._onReadyToPlay);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates the current sounds options such as maxdistance, loop...\r\n     * @param options A JSON object containing values named as the object properties\r\n     */\r\n    public updateOptions(options: ISoundOptions): void {\r\n        if (options) {\r\n            this.loop = options.loop ?? this.loop;\r\n            this.maxDistance = options.maxDistance ?? this.maxDistance;\r\n            this.useCustomAttenuation = options.useCustomAttenuation ?? this.useCustomAttenuation;\r\n            this.rolloffFactor = options.rolloffFactor ?? this.rolloffFactor;\r\n            this.refDistance = options.refDistance ?? this.refDistance;\r\n            this.distanceModel = options.distanceModel ?? this.distanceModel;\r\n            if (options.playbackRate !== undefined) {\r\n                this.setPlaybackRate(options.playbackRate);\r\n            }\r\n            if (options.spatialSound !== undefined) {\r\n                this.spatialSound = options.spatialSound;\r\n            }\r\n            if (options.volume !== undefined) {\r\n                this.setVolume(options.volume);\r\n            }\r\n            if (this._soundV2 instanceof _WebAudioStaticSound) {\r\n                let updated = false;\r\n                if (options.offset !== undefined) {\r\n                    this._optionsV2.startOffset = options.offset;\r\n                    updated = true;\r\n                }\r\n                if (options.length !== undefined) {\r\n                    this._soundV2.duration = options.length;\r\n                    updated = true;\r\n                }\r\n                if (updated && this.isPaused) {\r\n                    this.stop();\r\n                }\r\n            }\r\n\r\n            this._updateSpatialParameters();\r\n        }\r\n    }\r\n\r\n    private _updateSpatialParameters() {\r\n        if (!this.spatialSound) {\r\n            return;\r\n        }\r\n\r\n        const spatial = this._soundV2.spatial;\r\n\r\n        if (this.useCustomAttenuation) {\r\n            // Disable WebAudio attenuation.\r\n            spatial.distanceModel = \"linear\";\r\n            spatial.minDistance = 1;\r\n            spatial.maxDistance = Number.MAX_VALUE;\r\n            spatial.rolloffFactor = 1;\r\n            spatial.panningModel = \"equalpower\";\r\n        } else {\r\n            spatial.distanceModel = this.distanceModel;\r\n            spatial.minDistance = this.refDistance;\r\n            spatial.maxDistance = this.maxDistance;\r\n            spatial.rolloffFactor = this.rolloffFactor;\r\n            spatial.panningModel = this._optionsV2.spatialPanningModel || \"equalpower\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Switch the panning model to HRTF:\r\n     * Renders a stereo output of higher quality than equalpower â€” it uses a convolution with measured impulse responses from human subjects.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public switchPanningModelToHRTF() {\r\n        if (this.spatialSound) {\r\n            this._initSpatial();\r\n            this._soundV2.spatial.panningModel = \"HRTF\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Switch the panning model to Equal Power:\r\n     * Represents the equal-power panning algorithm, generally regarded as simple and efficient. equalpower is the default value.\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-a-spatial-3d-sound\r\n     */\r\n    public switchPanningModelToEqualPower() {\r\n        if (this.spatialSound) {\r\n            this._initSpatial();\r\n            this._soundV2.spatial.panningModel = \"equalpower\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Connect this sound to a sound track audio node like gain...\r\n     * @param soundTrackAudioNode the sound track audio node to connect to\r\n     */\r\n    public connectToSoundTrackAudioNode(soundTrackAudioNode: AudioNode): void {\r\n        const outputNode = this._soundV2._outNode;\r\n        if (outputNode) {\r\n            if (this._isOutputConnected) {\r\n                outputNode.disconnect();\r\n            }\r\n            outputNode.connect(soundTrackAudioNode);\r\n            this._isOutputConnected = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Transform this sound into a directional source\r\n     * @param coneInnerAngle Size of the inner cone in degree\r\n     * @param coneOuterAngle Size of the outer cone in degree\r\n     * @param coneOuterGain Volume of the sound outside the outer cone (between 0.0 and 1.0)\r\n     */\r\n    public setDirectionalCone(coneInnerAngle: number, coneOuterAngle: number, coneOuterGain: number): void {\r\n        if (coneOuterAngle < coneInnerAngle) {\r\n            Logger.Error(\"setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle.\");\r\n            return;\r\n        }\r\n\r\n        this._optionsV2.spatialConeInnerAngle = D2r(coneInnerAngle);\r\n        this._optionsV2.spatialConeOuterAngle = D2r(coneOuterAngle);\r\n        this._optionsV2.spatialConeOuterVolume = coneOuterGain;\r\n\r\n        this._initSpatial();\r\n        this._soundV2.spatial.coneInnerAngle = this._optionsV2.spatialConeInnerAngle;\r\n        this._soundV2.spatial.coneOuterAngle = this._optionsV2.spatialConeOuterAngle;\r\n        this._soundV2.spatial.coneOuterVolume = coneOuterGain;\r\n\r\n        this._isDirectional = true;\r\n\r\n        if (this.isPlaying && this.loop) {\r\n            this.stop();\r\n            this.play(0, this._optionsV2.startOffset, this._optionsV2.duration);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the inner angle for the directional cone.\r\n     */\r\n    public get directionalConeInnerAngle(): number {\r\n        return R2d(typeof this._optionsV2.spatialConeInnerAngle === \"number\" ? this._optionsV2.spatialConeInnerAngle : _SpatialAudioDefaults.coneInnerAngle);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the inner angle for the directional cone.\r\n     */\r\n    public set directionalConeInnerAngle(value: number) {\r\n        value = D2r(value);\r\n\r\n        if (value != this._optionsV2.spatialConeInnerAngle) {\r\n            if (this.directionalConeOuterAngle < value) {\r\n                Logger.Error(\"directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.\");\r\n                return;\r\n            }\r\n            this._optionsV2.spatialConeInnerAngle = value;\r\n            if (this.spatialSound) {\r\n                this._initSpatial();\r\n                this._soundV2.spatial.coneInnerAngle = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the outer angle for the directional cone.\r\n     */\r\n    public get directionalConeOuterAngle(): number {\r\n        return R2d(typeof this._optionsV2.spatialConeOuterAngle === \"number\" ? this._optionsV2.spatialConeOuterAngle : _SpatialAudioDefaults.coneOuterAngle);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the outer angle for the directional cone.\r\n     */\r\n    public set directionalConeOuterAngle(value: number) {\r\n        value = D2r(value);\r\n\r\n        if (value != this._optionsV2.spatialConeOuterAngle) {\r\n            if (value < this.directionalConeInnerAngle) {\r\n                Logger.Error(\"directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.\");\r\n                return;\r\n            }\r\n            this._optionsV2.spatialConeOuterAngle = value;\r\n            if (this.spatialSound) {\r\n                this._initSpatial();\r\n                this._soundV2.spatial.coneOuterAngle = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the position of the emitter if spatial sound is enabled\r\n     * @param newPosition Defines the new position\r\n     */\r\n    public setPosition(newPosition: Vector3): void {\r\n        if (this._optionsV2.spatialPosition && newPosition.equals(this._optionsV2.spatialPosition)) {\r\n            return;\r\n        }\r\n        if (!this._optionsV2.spatialPosition) {\r\n            this._optionsV2.spatialPosition = Vector3.Zero();\r\n        }\r\n        this._optionsV2.spatialPosition.copyFrom(newPosition);\r\n        if (this.spatialSound && !isNaN(newPosition.x) && !isNaN(newPosition.y) && !isNaN(newPosition.z)) {\r\n            this._initSpatial();\r\n            this._soundV2.spatial.position = newPosition;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the local direction of the emitter if spatial sound is enabled\r\n     * @param newLocalDirection Defines the new local direction\r\n     */\r\n    public setLocalDirectionToMesh(newLocalDirection: Vector3): void {\r\n        this._localDirection = newLocalDirection;\r\n\r\n        if (this._connectedTransformNode && this.isPlaying) {\r\n            this._updateDirection();\r\n        }\r\n    }\r\n\r\n    private _updateDirection() {\r\n        if (!this._connectedTransformNode || !this.spatialSound) {\r\n            return;\r\n        }\r\n\r\n        const mat = this._connectedTransformNode.getWorldMatrix();\r\n        const direction = Vector3.TransformNormal(this._localDirection, mat);\r\n        direction.normalize();\r\n\r\n        this._initSpatial();\r\n        this._soundV2.spatial.orientation = direction;\r\n    }\r\n\r\n    private _initSpatial() {\r\n        this._soundV2._isSpatial = true;\r\n\r\n        if (this._optionsV2.spatialDistanceModel === undefined) {\r\n            this._optionsV2.spatialDistanceModel = \"linear\";\r\n            this._soundV2.spatial.distanceModel = \"linear\";\r\n        }\r\n\r\n        if (this._optionsV2.spatialMaxDistance === undefined) {\r\n            this._optionsV2.spatialMaxDistance = 100;\r\n            this._soundV2.spatial.maxDistance = 100;\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public updateDistanceFromListener() {\r\n        if (this._soundV2._outNode && this._connectedTransformNode && this.useCustomAttenuation && this._scene.activeCamera) {\r\n            const distance = this._scene.audioListenerPositionProvider\r\n                ? this._connectedTransformNode.position.subtract(this._scene.audioListenerPositionProvider()).length()\r\n                : this._connectedTransformNode.getDistanceToCamera(this._scene.activeCamera);\r\n            this._soundV2.volume = this._customAttenuationFunction(this._volume, distance, this.maxDistance, this.refDistance, this.rolloffFactor);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets a new custom attenuation function for the sound.\r\n     * @param callback Defines the function used for the attenuation\r\n     * @see https://doc.babylonjs.com/legacy/audio#creating-your-own-custom-attenuation-function\r\n     */\r\n    public setAttenuationFunction(callback: (currentVolume: number, currentDistance: number, maxDistance: number, refDistance: number, rolloffFactor: number) => number): void {\r\n        this._customAttenuationFunction = callback;\r\n    }\r\n\r\n    /**\r\n     * Play the sound\r\n     * @param time (optional) Start the sound after X seconds. Start immediately (0) by default.\r\n     * @param offset (optional) Start the sound at a specific time in seconds\r\n     * @param length (optional) Sound duration (in seconds)\r\n     */\r\n    public play(time?: number, offset?: number, length?: number): void {\r\n        const audioEngine = AbstractEngine.audioEngine;\r\n        audioEngine?.unlock();\r\n\r\n        // WebAudio sound sources have no `play` function because they are always playing.\r\n        if (this._soundV2 instanceof _WebAudioSoundSource) {\r\n            return;\r\n        }\r\n\r\n        if (this._isReadyToPlay && this._scene.audioEnabled) {\r\n            // The sound can only resume from pause when the `time`, `offset` and `length` args are not set.\r\n            if (this._soundV2.state === SoundState.Paused && (time !== undefined || offset !== undefined || length !== undefined)) {\r\n                this._soundV2.stop();\r\n            }\r\n\r\n            try {\r\n                TmpPlayOptions.duration = length || 0;\r\n                TmpPlayOptions.startOffset = offset !== undefined ? offset || this._optionsV2.startOffset! : this._optionsV2.startOffset!;\r\n                TmpPlayOptions.waitTime = time || 0;\r\n                TmpPlayOptions.loop = undefined;\r\n                TmpPlayOptions.loopStart = undefined;\r\n                TmpPlayOptions.loopEnd = undefined;\r\n                TmpPlayOptions.volume = undefined;\r\n\r\n                if (audioEngine?.unlocked) {\r\n                    this._soundV2.play(TmpPlayOptions);\r\n                } else {\r\n                    // Wait a bit for FF as context seems late to be ready.\r\n                    setTimeout(() => {\r\n                        (this._soundV2 as _WebAudioStaticSound | _WebAudioStreamingSound).play(TmpPlayOptions);\r\n                    }, 500);\r\n                }\r\n            } catch (ex) {\r\n                Logger.Error(\"Error while trying to play audio: \" + this.name + \", \" + ex.message);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _onended = () => {\r\n        if (this.onended) {\r\n            this.onended();\r\n        }\r\n        this.onEndedObservable.notifyObservers(this);\r\n    };\r\n\r\n    /**\r\n     * Stop the sound\r\n     * @param time (optional) Stop the sound after X seconds. Stop immediately (0) by default.\r\n     */\r\n    public stop(time?: number): void {\r\n        if (!this._soundV2) {\r\n            return;\r\n        }\r\n\r\n        // WebAudio sound sources have no `stop` function because they are always playing.\r\n        if (this._soundV2 instanceof _WebAudioSoundSource) {\r\n            return;\r\n        }\r\n\r\n        TmpStopOptions.waitTime = time || 0;\r\n        this._soundV2.stop(TmpStopOptions);\r\n    }\r\n\r\n    /**\r\n     * Put the sound in pause\r\n     */\r\n    public pause(): void {\r\n        if (!this._soundV2) {\r\n            return;\r\n        }\r\n\r\n        // WebAudio sound sources have no `pause` function because they are always playing.\r\n        if (this._soundV2 instanceof _WebAudioSoundSource) {\r\n            return;\r\n        }\r\n\r\n        this._soundV2.pause();\r\n    }\r\n\r\n    /**\r\n     * Sets a dedicated volume for this sounds\r\n     * @param newVolume Define the new volume of the sound\r\n     * @param time Define time for gradual change to new volume\r\n     */\r\n    public setVolume(newVolume: number, time?: number): void {\r\n        if (!this.isReady()) {\r\n            this._onReady.addOnce(() => {\r\n                this.setVolume(newVolume, time);\r\n            });\r\n            return;\r\n        }\r\n\r\n        TmpRampOptions.duration = time || 0;\r\n        this._soundV2.setVolume(newVolume, TmpRampOptions);\r\n        this._volume = newVolume;\r\n    }\r\n\r\n    /**\r\n     * Set the sound play back rate\r\n     * @param newPlaybackRate Define the playback rate the sound should be played at\r\n     */\r\n    public setPlaybackRate(newPlaybackRate: number): void {\r\n        if (this._soundV2 instanceof _WebAudioStaticSound) {\r\n            this._soundV2.playbackRate = newPlaybackRate;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the sound play back rate.\r\n     * @returns the  play back rate of the sound\r\n     */\r\n    public getPlaybackRate(): number {\r\n        if (this._soundV2 instanceof _WebAudioStaticSound) {\r\n            return this._soundV2.playbackRate;\r\n        }\r\n\r\n        return 1;\r\n    }\r\n\r\n    /**\r\n     * Gets the volume of the sound.\r\n     * @returns the volume of the sound\r\n     */\r\n    public getVolume(): number {\r\n        return this._volume;\r\n    }\r\n\r\n    /**\r\n     * Attach the sound to a dedicated mesh\r\n     * @param transformNode The transform node to connect the sound with\r\n     * @see https://doc.babylonjs.com/legacy/audio#attaching-a-sound-to-a-mesh\r\n     */\r\n    public attachToMesh(transformNode: TransformNode): void {\r\n        if (this._connectedTransformNode && this._registerFunc) {\r\n            this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc);\r\n            this._registerFunc = null;\r\n        }\r\n        this._connectedTransformNode = transformNode;\r\n        if (!this.spatialSound) {\r\n            this.spatialSound = true;\r\n            if (this.isPlaying && this.loop) {\r\n                this.stop();\r\n                this.play(0, this._optionsV2.startOffset, this._optionsV2.duration);\r\n            }\r\n        }\r\n        this._onRegisterAfterWorldMatrixUpdate(this._connectedTransformNode);\r\n        this._registerFunc = (transformNode: TransformNode) => this._onRegisterAfterWorldMatrixUpdate(transformNode);\r\n        this._connectedTransformNode.registerAfterWorldMatrixUpdate(this._registerFunc);\r\n    }\r\n\r\n    /**\r\n     * Detach the sound from the previously attached mesh\r\n     * @see https://doc.babylonjs.com/legacy/audio#attaching-a-sound-to-a-mesh\r\n     */\r\n    public detachFromMesh() {\r\n        if (this._connectedTransformNode && this._registerFunc) {\r\n            this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc);\r\n            this._registerFunc = null;\r\n            this._connectedTransformNode = null;\r\n        }\r\n    }\r\n\r\n    private _onRegisterAfterWorldMatrixUpdate(node: TransformNode): void {\r\n        if (!(<any>node).getBoundingInfo) {\r\n            this.setPosition(node.absolutePosition);\r\n        } else {\r\n            const mesh = node as AbstractMesh;\r\n            const boundingInfo = mesh.getBoundingInfo();\r\n            this.setPosition(boundingInfo.boundingSphere.centerWorld);\r\n        }\r\n        if (this._isDirectional && this.isPlaying) {\r\n            this._updateDirection();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clone the current sound in the scene.\r\n     * @returns the new sound clone\r\n     */\r\n    public clone(): Nullable<Sound> {\r\n        if (!(this._soundV2 instanceof _WebAudioStaticSound)) {\r\n            return null;\r\n        }\r\n\r\n        const currentOptions: ISoundOptions = {\r\n            autoplay: this.autoplay,\r\n            loop: this.loop,\r\n            volume: this._volume,\r\n            spatialSound: this.spatialSound,\r\n            maxDistance: this.maxDistance,\r\n            useCustomAttenuation: this.useCustomAttenuation,\r\n            rolloffFactor: this.rolloffFactor,\r\n            refDistance: this.refDistance,\r\n            distanceModel: this.distanceModel,\r\n        };\r\n        const clonedSound = new Sound(this.name + \"_cloned\", this._soundV2.buffer, this._scene, null, currentOptions);\r\n        (clonedSound._optionsV2 as any) = this._optionsV2;\r\n        if (this.useCustomAttenuation) {\r\n            clonedSound.setAttenuationFunction(this._customAttenuationFunction);\r\n        }\r\n        return clonedSound;\r\n    }\r\n\r\n    /**\r\n     * Gets the current underlying audio buffer containing the data\r\n     * @returns the audio buffer\r\n     */\r\n    public getAudioBuffer(): Nullable<AudioBuffer> {\r\n        if (this._soundV2 instanceof _WebAudioStaticSound) {\r\n            return this._soundV2.buffer._audioBuffer;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets the WebAudio AudioBufferSourceNode, lets you keep track of and stop instances of this Sound.\r\n     * @returns the source node\r\n     */\r\n    public getSoundSource(): Nullable<AudioBufferSourceNode> {\r\n        // return this._soundSource;\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets the WebAudio GainNode, gives you precise control over the gain of instances of this Sound.\r\n     * @returns the gain node\r\n     */\r\n    public getSoundGain(): Nullable<GainNode> {\r\n        return this._soundV2._outNode as GainNode;\r\n    }\r\n\r\n    /**\r\n     * Serializes the Sound in a JSON representation\r\n     * @returns the JSON representation of the sound\r\n     */\r\n    public serialize(): any {\r\n        const serializationObject: any = {\r\n            name: this.name,\r\n            url: this._url,\r\n            autoplay: this.autoplay,\r\n            loop: this.loop,\r\n            volume: this._volume,\r\n            spatialSound: this.spatialSound,\r\n            maxDistance: this.maxDistance,\r\n            rolloffFactor: this.rolloffFactor,\r\n            refDistance: this.refDistance,\r\n            distanceModel: this.distanceModel,\r\n            playbackRate: this.getPlaybackRate(),\r\n            panningModel: this._soundV2.spatial.panningModel,\r\n            soundTrackId: this.soundTrackId,\r\n            metadata: this.metadata,\r\n        };\r\n\r\n        if (this.spatialSound) {\r\n            if (this._connectedTransformNode) {\r\n                serializationObject.connectedMeshId = this._connectedTransformNode.id;\r\n            }\r\n\r\n            serializationObject.position = this._soundV2.spatial.position.asArray();\r\n            serializationObject.refDistance = this.refDistance;\r\n            serializationObject.distanceModel = this.distanceModel;\r\n\r\n            serializationObject.isDirectional = this._isDirectional;\r\n            serializationObject.localDirectionToMesh = this._localDirection.asArray();\r\n            serializationObject.coneInnerAngle = this.directionalConeInnerAngle;\r\n            serializationObject.coneOuterAngle = this.directionalConeOuterAngle;\r\n            serializationObject.coneOuterGain = this._soundV2.spatial.coneOuterVolume;\r\n        }\r\n\r\n        return serializationObject;\r\n    }\r\n\r\n    /**\r\n     * Parse a JSON representation of a sound to instantiate in a given scene\r\n     * @param parsedSound Define the JSON representation of the sound (usually coming from the serialize method)\r\n     * @param scene Define the scene the new parsed sound should be created in\r\n     * @param rootUrl Define the rooturl of the load in case we need to fetch relative dependencies\r\n     * @param sourceSound Define a sound place holder if do not need to instantiate a new one\r\n     * @returns the newly parsed sound\r\n     */\r\n    public static Parse(parsedSound: any, scene: Scene, rootUrl: string, sourceSound?: Sound): Sound {\r\n        const soundName = parsedSound.name;\r\n        let soundUrl;\r\n        if (parsedSound.url) {\r\n            soundUrl = rootUrl + parsedSound.url;\r\n        } else {\r\n            soundUrl = rootUrl + soundName;\r\n        }\r\n        const options = {\r\n            autoplay: parsedSound.autoplay,\r\n            loop: parsedSound.loop,\r\n            volume: parsedSound.volume,\r\n            spatialSound: parsedSound.spatialSound,\r\n            maxDistance: parsedSound.maxDistance,\r\n            rolloffFactor: parsedSound.rolloffFactor,\r\n            refDistance: parsedSound.refDistance,\r\n            distanceModel: parsedSound.distanceModel,\r\n            playbackRate: parsedSound.playbackRate,\r\n        };\r\n        let newSound: Sound;\r\n        if (!sourceSound) {\r\n            newSound = new Sound(\r\n                soundName,\r\n                soundUrl,\r\n                scene,\r\n                () => {\r\n                    scene.removePendingData(newSound);\r\n                },\r\n                options\r\n            );\r\n            scene.addPendingData(newSound);\r\n        } else {\r\n            const setBufferAndRun = () => {\r\n                _RetryWithInterval(\r\n                    () => sourceSound._isReadyToPlay,\r\n                    () => {\r\n                        const audioBuffer = sourceSound.getAudioBuffer();\r\n                        if (audioBuffer) {\r\n                            newSound.setAudioBuffer(audioBuffer);\r\n                        }\r\n                        newSound._isReadyToPlay = true;\r\n                        if (newSound.autoplay) {\r\n                            newSound.play(0, sourceSound._optionsV2.startOffset, sourceSound._optionsV2.duration);\r\n                        }\r\n                    },\r\n                    undefined,\r\n                    300\r\n                );\r\n            };\r\n            newSound = new Sound(soundName, new ArrayBuffer(0), scene, null, options);\r\n            setBufferAndRun();\r\n        }\r\n        if (parsedSound.position) {\r\n            const soundPosition = Vector3.FromArray(parsedSound.position);\r\n            newSound.setPosition(soundPosition);\r\n        }\r\n        if (parsedSound.isDirectional) {\r\n            newSound.setDirectionalCone(parsedSound.coneInnerAngle || 360, parsedSound.coneOuterAngle || 360, parsedSound.coneOuterGain || 0);\r\n            if (parsedSound.localDirectionToMesh) {\r\n                const localDirectionToMesh = Vector3.FromArray(parsedSound.localDirectionToMesh);\r\n                newSound.setLocalDirectionToMesh(localDirectionToMesh);\r\n            }\r\n        }\r\n        if (parsedSound.connectedMeshId) {\r\n            const connectedMesh = scene.getMeshById(parsedSound.connectedMeshId);\r\n            if (connectedMesh) {\r\n                newSound.attachToMesh(connectedMesh);\r\n            }\r\n        }\r\n        if (parsedSound.metadata) {\r\n            newSound.metadata = parsedSound.metadata;\r\n        }\r\n        return newSound;\r\n    }\r\n}\r\n\r\n// Register Class Name\r\nRegisterClass(\"BABYLON.Sound\", Sound);\r\n"]}